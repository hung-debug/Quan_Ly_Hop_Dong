<div class="container-fluid">

  <div class="contract-determine">
    <div style="margin-right: 50px">
      <input id="order-organization" class="contract-total" style="width: 25px; height: 25px" type="number"
        [(ngModel)]="data_organization.ordering" (focusout)="onChangeValue($event, 'order-organization')"
        oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
    </div>
    <div class="contract--content">
      <div class="contract__content--title-doi-tac">
        <div style="width: 85px">
          {{ "organization.me" | translate | uppercase }}&nbsp;<span style="color: red">*</span>
        </div>
        <input class="input1" type="text" [(ngModel)]="data_organization.name" />

        <!--Ẩn luồng xử lý-->
        <!-- <div style="width: 120px; margin-left: 5px">
          {{'hide.processing.thread' | translate}}
        </div>
        <input type ="checkbox" [(ngModel)]="data_organization.hideFlow"> -->
      </div>

      <div class="contract__content--participants">

        <!--người xem xét-->
        <div class="participants-border">
          <div class="label">{{'user.view' | translate}}</div>
          <div class="participants--content" *ngFor="let d of getOriganzationReviewer(); let index = index">
            <input [id]="'ordering-organzation-view-' + index" class="col-md-1 contract-total"
              (focusout)="onChangeValue($event,'ordering-organzation-view-' + index)" style="width: 25px; height: 25px"
              type="number" [(ngModel)]="d.ordering"
              oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');"
              [disabled]="getOriganzationReviewer().length == 1">
            <div class="col-md-10 participants__content--input" style="display: flex; flex-direction: column">

              <!--Chọn {{'Đăng nhập bằng email' | translate}} hoặc số điện thoại cho nguoi xem xet to chuc-->
              <div class="participants--input" style="display: flex">
                <div class="participants__name">
                  <div class="label_detail text-color">

                    <div>
                      <input (change)="changeTypeSign(d)" type="radio" name="checkPhoneMailOrgViewer_{{index}}"
                        [value]="email" [(ngModel)]="d.login_by" />
                    </div>&nbsp;
                    <div>
                      {{'Đăng nhập bằng email' | translate}}
                    </div>
                  </div>
                </div>
                <div class="participants__name">
                  <div class="label_detail text-color">
                    <div>
                      <input (change)="changeTypeSign(d)" type="radio" name="checkPhoneMailOrgViewer_{{index}}"
                        [(ngModel)]="d.login_by" [value]="phone" />
                    </div>&nbsp;
                    <div>
                      {{'Đăng nhập bằng số điện thoại' | translate}}
                    </div>
                  </div>
                </div>
              </div>

              <div class="participants--input" style="display: flex">
                <div class="participants__name">
                  <div class="label_detail text-color">{{'user.name' | translate}}&nbsp;<span
                      class="required-title">*</span></div>
                  <div class="input-data">
                    <img src="assets/img/icon_name.svg" class="input-img">

                    <input *ngIf="d.login_by === 'email'" type="text" placeholder="{{'nhap_ho_va_ten' | translate}}"
                      (focusin)="onFocusIn($event, index, 'view')" (ngxInputSearch)="doTheSearch($event, index, 'view')"
                      [(ngModel)]="d.name" (focusout)="onFocusOut($event, d)">

                    <input *ngIf="d.login_by === 'phone'" type="text" placeholder="{{'nhap_ho_va_ten' | translate}}"
                      (focusin)="onFocusIn($event, index, 'view')" [(ngModel)]="d.name"
                      (focusout)="onFocusOut($event, d)">
                  </div>
                  <div class="search-name"
                    *ngIf="this.arrSearch[index] && this.arrSearchNameView && arrSearchNameView.length > 0">
                    <button  class="search-name-items" *ngFor="let t of this.arrSearchNameView"
                      (click)="onSelectName(t, d)">{{t.name}} ({{t.email}})
                    </button>
                  </div>
                </div>

                <!--NB-->
                <div class="participants__name" *ngIf="d.login_by == 'email' && this.site == 'NB'">
                  <div class="label_detail text-color">Email&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/login_email.svg" class="input-img">
                    <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>

                <div class="participants__name" *ngIf="d.login_by == 'phone' && this.site == 'NB'">
                  <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div style="display: flex;">
                    <div class="input-data" style="width: 91%;margin-right: -3%;">
                      <img class="input-img">
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                    </div>

                    <div class="participants__name" style="width: 17%;margin-left: 5%;">
                      <div class="input-data">
                        <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                          <div *ngIf="d.locale =='vi'">
                            <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div *ngIf="d.locale =='en'">
                            <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                            <div class="switch-language">
                              <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                                <div class="language">{{ "vie" | translate }}</div>
                              </button>
                            </div>
                            <div class="switch-language">
                              <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                                <div class="language">{{ "eng" | translate }}</div>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>


                <!--KD-->
                <div *ngIf="d.login_by === 'email' && this.site == 'KD'" class="participants__name">
                  <div class="label_detail text-color">Email&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/login_email.svg" class="input-img">
                    <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>

                <div *ngIf="d.login_by === 'phone' && this.site == 'KD'" class="participants__name">
                  <div style="display: flex;">
                    <div class="participants__name" style="width: 91%;">
                      <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                        <span class="required-title">*</span>
                      </div>
                      <div class="input-data">
                        <img class="input-img">
                        <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                      </div>
                    </div>

                    <div class="participants__name" style="width: 16%; margin-left: 2%;">
                      <div class="label_detail text-color">
                        <span class="required-title"></span>
                      </div>
                      <div class="input-data">

                        <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                          <div *ngIf="d.locale =='vi'">
                            <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div *ngIf="d.locale =='en'">
                            <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                            <div class="switch-language">
                              <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                                <div class="language">{{ "vie" | translate }}</div>
                              </button>
                            </div>
                            <div class="switch-language">
                              <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                                <div class="language">{{ "eng" | translate }}</div>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--NB email-->
              <div *ngIf="this.site == 'NB' && d.login_by === 'email'" class="participants--input"
                style="display: flex">
                <div class="participants__name" style="width:80%; margin-right: -4%;">
                  <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<div style="color: #ffc107;">
                      ({{'receive.contract.process' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <img class="input-img">
                    <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                  </div>
                </div>

                <div class="participants__name" style="width: 6%">
                  <div class="label_detail text-color">
                    <span class="required-title"></span>
                  </div>
                  <div class="input-data">
                    <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                      <div *ngIf="d.locale =='vi'">
                        <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div *ngIf="d.locale =='en'">
                        <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                        <div class="switch-language">
                          <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                            <div class="language">{{ "vie" | translate }}</div>
                          </button>
                        </div>
                        <div class="switch-language">
                          <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                            <div class="language">{{ "eng" | translate }}</div>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
            <div class="col-md-1 delete-element" (click)="deleteOriganzationReviewer(index)">
              <img src="assets/img/border_close.svg" alt="close.vn">
              <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn">
            </div>
          </div>
          <div class="participants--add">
            <u class="label text-color" (click)="addOriganzationReviewer()">{{'btn.add.user.view' | translate}}</u>
          </div>
        </div>

        <!--Người ký-->
        <div class="participants-border">
          <div class="label">{{ "user.sign" | translate }}</div>
          <div class="participants--content" *ngFor="let d of getOriganzationSignature(); let index = index">
            <input [id]="'ordering-sign-' + index" class="col-md-1 contract-total"
              (focusout)="onChangeValue($event, 'ordering-sign-' + index)" style="width: 25px; height: 25px"
              type="number" [(ngModel)]="d.ordering"
              oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');"
              [disabled]="getOriganzationSignature().length == 1" />
            <div class="col-md-10 participants__content--input" style="display: flex; flex-direction: column">

              <!--Chọn   {{'Đăng nhập bằng email' | translate}} hoặc số điện thoại với người ký tổ chức của tôi-->
              <div class="participants--input" style="display: flex">
                <div class="participants__name">
                  <div class="label_detail text-color">
                    <div>
                      <input (change)="changeTypeSign(d, index,null,'signer')" [(ngModel)]="d.login_by" type="radio"
                        name="checkPhoneMailOrgSign_{{index}}" [value]="email" />
                    </div>&nbsp;
                    <div>
                      {{'typeOfSignEmail' | translate}}
                    </div>
                  </div>
                </div>
                <div class="participants__name">
                  <div class="label_detail text-color">
                    <div>
                      <input (change)="changeTypeSign(d, index,null,'signer')" [(ngModel)]="d.login_by" type="radio"
                        name="checkPhoneMailOrgSign_{{index}}" [value]="phone" />
                    </div>&nbsp;
                    <div>
                      {{'typeOfSignPhone' | translate}}
                    </div>
                  </div>
                </div>
              </div>

              <div class="participants--input" style="display: flex">
                <div class="participants__name">
                  <div class="label_detail text-color">
                    {{ "user.name" | translate }}&nbsp;<span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/icon_name.svg" class="input-img" />
                    <input *ngIf="d.login_by === 'email'" type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}"
                      (focusin)="onFocusIn($event, index, 'signature')"
                      (ngxInputSearch)="doTheSearch($event, index, 'signature')" [(ngModel)]="d.name"
                      (focusout)="onFocusOut($event, d)" />

                    <input *ngIf="d.login_by === 'phone'" type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}"
                      (focusin)="onFocusIn($event, index, 'signature')" [(ngModel)]="d.name"
                      (focusout)="onFocusOut($event, d)" />
                  </div>
                  <div class="search-name" *ngIf="
                      this.arrSearch[index] &&
                      this.arrSearchNameSignature &&
                      arrSearchNameSignature.length > 0
                    ">
                    <button class="search-name-items" *ngFor="let t of this.arrSearchNameSignature"
                      (click)="onSelectName(t, d)">
                      {{ t.name }} ({{ t.email }})
                    </button>
                  </div>
                </div>

                <div class="participants__name">
                  <div class="label_detail text-color">
                    {{ "user.sign-type" | translate }}&nbsp;<span class="required-title">*</span>
                  </div>

                  <!--Tổ chức của tôi chọn loại ký-->
                  <ng-multiselect-dropdown [(ngModel)]="d.sign_type" placeholder="{{'choose' | translate }}"
                    [settings]="dropdownSignTypeSettings" [data]="d.isListSignNotPerson ? d.isListSignNotPerson : this.getListSignType('org')" (onSelect)="onItemSelect($event)"
                    (onDeSelect)="deSelectOrg($event)" (ngModelChange)="selectWithOtp($event, d, 'organization')">
                    <ng-template #optionsTemplate let-item let-option="option" let-id="id" let-isSelected="isSelected">
                      <div style="padding: 1px 10px; margin-right: 10px; right: 2px; top: -2px;">
                        <label style="color: #333; font-weight: normal;"
                          [ngStyle]="{ 'font-weight': isSelected? 'bold':' normal','color': getContractConnectItems[id].isDisabled? 'lightgrey': ''}">
                          {{getContractConnectItems[id].name}}
                        </label>
                      </div>
                    </ng-template>
                  </ng-multiselect-dropdown>
                </div>
              </div>

              <!--KD-->
              <div *ngIf="this.site == 'KD'" class="participants--input" style="display: flex">
                <div *ngIf="d.login_by === 'email'" class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">Email&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/login_email.svg" class="input-img">
                    <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>

                <div *ngIf="d.login_by === 'phone'" class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div style="display: flex;">
                    <div class="input-data" style="width: 85%;">
                      <img class="input-img">
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                    </div>

                    <div class="input-data" style="width: 7%;margin-left: 8%;">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu2" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu2" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu2" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--NB email-->
              <div *ngIf="this.site == 'NB' && d.login_by === 'email'" class="participants--input"
                style="display: flex">
                <div class="participants__name" style="margin-left: 4%;">
                  <div class="label_detail text-color">Email&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/login_email.svg" class="input-img">
                    <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>

                <div class="participants__name" style="width: 34%; margin-left: 8%;">
                  <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                    <div style="color: #ffc107;">({{'receive.contract.process' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                    <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                  </div>
                </div>

                <div class="participants__name" style="width: 6%; margin-right: 4%;">
                  <div class="label_detail text-color">
                    <span class="required-title"></span>
                  </div>
                  <div class="input-data">
                    <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                      <div *ngIf="d.locale =='vi'">
                        <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div *ngIf="d.locale =='en'">
                        <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                        <div class="switch-language">
                          <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                            <div class="language">{{ "vie" | translate }}</div>
                          </button>
                        </div>
                        <div class="switch-language">
                          <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                            <div class="language">{{ "eng" | translate }}</div>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--NB phone-->
              <div *ngIf="this.site == 'NB' && d.login_by === 'phone'" class="participants--input"
                style="display: flex">
                <div class="participants__name" style="width:80%; margin-right: -4%;">
                  <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                    <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>

                <div class="participants__name" style="width: 6%">
                  <div class="label_detail text-color">
                    <span class="required-title"></span>
                  </div>
                  <div class="input-data">
                    <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                      <div *ngIf="d.locale =='vi'">
                        <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div *ngIf="d.locale =='en'">
                        <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                        <div class="switch-language">
                          <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                            <div class="language">{{ "vie" | translate }}</div>
                          </button>
                        </div>
                        <div class="switch-language">
                          <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                            <div class="language">{{ "eng" | translate }}</div>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--trường hiển thị khi người ký tổ chức của tôi chọn loại ký là usbtoken-->
              <div class="participants--input" style="display: flex" *ngIf="getDataSignUSBToken(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;<span
                      class="required-title">*</span>
                    <div style="color: #ffc107;">({{'info.token' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                  </div>
                </div>
              </div>

              <!--trường hiển thị khi người ký tổ chức của tôi chọn loại ký là hsm-->
              <div class="participants--input" style="display: flex" *ngIf="getDataSignHsm(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;<span
                      class="required-title">*</span>
                    <div style="color: #ffc107;">({{'info.hsm' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                  </div>
                </div>
              </div>


              <div class="participants--input" style="display: flex" *ngIf="getDataSignEkyc(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">
                    CMT/CCCD&nbsp;<span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{ 'enter.cardId' | translate }}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
                  </div>
                </div>
              </div>

              <!--trường hiển thị khi người ký tổ chức của tôi chọn loại ký là chứng thư số-->
              <div class="participants--input" style="display: flex" *ngIf="getDataSignCert(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;
                    <span class="required-title">*</span>
                    <div style="color: #ffc107;">({{'info.cert' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                  </div>
                </div>
              </div>

            </div>
            <div *ngIf="getOriganzationSignature().length > 1" class="col-md-1 delete-element"
              (click)="deleteOriganzationSignature(index)">
              <img src="assets/img/border_close.svg" alt="close.vn" />
              <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
            </div>
            <div *ngIf="getOriganzationSignature().length == 1" class="col-md-1 delete-element"></div>
          </div>
          <div class="participants--add">
            <u class="label text-color" style="color: #106db6" (click)="addOriganzationSignature()">{{
              "btn.add.user.sign" | translate }}</u>
          </div>
        </div>

        <!--Văn thư tổ chức của tôi-->
        <div class="participants-border">
          <div class="label">{{ "user.doc" | translate }}</div>
          <div class="participants--content" *ngFor="let d of getOriganzationDocument(); let index = index">
            <input [id]="'ordering-doc-' + index" class="col-md-1 contract-total"
              (focusout)="onChangeValue($event, 'ordering-doc-' + index)" style="width: 25px; height: 25px"
              type="number" [(ngModel)]="d.ordering" [disabled]="getOriganzationDocument().length == 1"
              oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
            <div class="col-md-10 participants__content--input" style="display: flex; flex-direction: column">

              <div class="participants--input" style="display: flex">
                <div class="participants__name">
                  <div class="label_detail text-color">
                    {{ "user.name" | translate }}&nbsp;<span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/icon_name.svg" class="input-img" />
                    <input type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}"
                      (focusin)="onFocusIn($event, index, 'doc')" (ngxInputSearch)="doTheSearch($event, index, 'doc')"
                      [(ngModel)]="d.name" (focusout)="onFocusOut($event, d)" />
                  </div>
                  <div class="search-name" *ngIf="
                      this.arrSearch[index] &&
                      this.arrSearchNameDoc &&
                      arrSearchNameDoc.length > 0
                    ">
                    <button class="search-name-items" *ngFor="let t of this.arrSearchNameDoc"
                      (click)="onSelectName(t, d)">
                      {{ t.name }} ({{ t.email }})
                    </button>
                  </div>
                </div>

                <div class="participants__name">
                  <div class="label_detail text-color">
                    {{ "user.sign-type" | translate }}&nbsp;<span class="required-title">*</span>
                  </div>

                  <!--Văn thư tổ chức của tôi chọn loại ký-->
                  <ng-multiselect-dropdown [(ngModel)]="d.sign_type" placeholder="{{ 'choose' | translate }}"
                    [settings]="dropdownSignTypeSettings" [data]="signType_doc"
                    (ngModelChange)="selectWithOtp($event, d, 'organization')">
                    <ng-template #optionsTemplate let-item let-option="option" let-id="id" let-isSelected="isSelected">
                      <div style="
                          padding: 1px 10px;
                          margin-right: 10px;
                          right: 2px;
                          top: -2px;
                        ">
                        <label style="color: #333; font-weight: normal" [ngStyle]="{
                            'font-weight': isSelected ? 'bold' : ' normal',
                            color: getContractConnectItems[id].isDisabled
                              ? 'lightgrey'
                              : ''
                          }">
                          {{ getContractConnectItems[id].name }}
                        </label>
                      </div>
                    </ng-template>
                  </ng-multiselect-dropdown>
                </div>
              </div>

              <!--NB-->
              <div class="participants--input" style="display: flex" *ngIf="this.site == 'NB'">
                <div class="participants__name" style="margin-left: 4%;">
                  <div class="label_detail text-color">Email&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/login_email.svg" class="input-img">
                    <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>

                <div class="participants__name" style="width: 34%; margin-left: 8%;">
                  <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<div style="color: #ffc107;">
                      ({{'receive.contract.process' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <img class="input-img">
                    <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                  </div>
                </div>

                <div class="participants__name" style="width: 6%; margin-right: 4%;">
                  <div class="label_detail text-color">
                    <span class="required-title"></span>
                  </div>
                  <div class="input-data">
                    <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                      <div *ngIf="d.locale =='vi'">
                        <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div *ngIf="d.locale =='en'">
                        <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                          id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                      </div>
                      <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                        <div class="switch-language">
                          <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                            <div class="language">{{ "vie" | translate }}</div>
                          </button>
                        </div>
                        <div class="switch-language">
                          <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                            <div class="language">{{ "eng" | translate }}</div>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--KD-->
              <div class="participants--input" style="display: flex" *ngIf="this.site == 'KD'">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">Email&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <img src="assets/img/login_email.svg" class="input-img">
                    <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                  </div>
                </div>
              </div>

              <!--trường hiển thị khi văn thư tổ chức của tôi chọn loại ký là usb token-->
              <div class="participants--input" style="display: flex" *ngIf="getDataSignUSBToken(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;
                    <span class="required-title">*</span>
                    <div style="color: #ffc107;">({{'Thông tin trong USB token' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                  </div>
                </div>
              </div>


              <!--trường hiển thị khi văn thư tổ chức của tôi chọn loại ký là hsm-->
              <div class="participants--input" style="display: flex" *ngIf="getDataSignHsm(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'tax_code' | translate}}&nbsp;
                    <span class="required-title">*</span>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{'enter.tax.code' | translate}}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                  </div>
                </div>
              </div>

              <!--trường hiển thị khi văn thư tổ chức của tôi chọn loại ký là chứng thư số-->
              <div class="participants--input" style="display: flex" *ngIf="getDataSignCert(d).length > 0">
                <div class="participants__name" style="width: 91%">
                  <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;
                    <span class="required-title">*</span>
                    <div style="color: #ffc107;">({{'info.cert' | translate}})</div>
                  </div>
                  <div class="input-data">
                    <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                      oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                  </div>
                </div>
              </div>

            </div>
            <div class="col-md-1 delete-element" (click)="deleteOriganzationDocument(index)">
              <img src="assets/img/border_close.svg" alt="close.vn" />
              <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
            </div>
          </div>
          <div class="participants--add">
            <u class="label text-color" style="color: #106db6" (click)="addOriganzationDocument()">{{ "btn.add.user.doc"
              | translate }}</u>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--  Đối tác-->
  <div class="contract-determine" *ngFor="let item of dataParnterOrganization(); let id = index" style="display: flex">
    <div style="margin-right: 50px">
      <input [id]="'ordering-partner-' + id" class="contract-total"
        (focusout)="onChangeValue($event, 'ordering-partner-' + id)" style="width: 25px; height: 25px" type="number"
        [(ngModel)]="item.ordering"
        oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
    </div>
    <div class="contract--content">
      <div class="contract__content--title-doi-tac">
        <div style="width: 85px">
          {{ "doi_tac" | translate | uppercase }}&nbsp;<span style="color: red">*</span>
          -
        </div>
        <input class="input1" type="text" placeholder="{{
            (item.type == 2 ? 'nhap_ten_doi_tac_to_chuc' : '') | translate
          }}" [(ngModel)]="item.name" [disabled]="item.type == 3" />

          <!--Ẩn luồng xử lý-->
          <!-- <div style="width: 120px; margin-left: 5px">
            {{'hide.processing.thread' | translate}}
          </div>
          <input type ="checkbox" [(ngModel)]="item.hideFlow"> -->
      </div>
      <div *ngIf="this.dataParnterOrganization().length >= 1" style="display: flex; justify-content: flex-end">
        <u class="label text-color" (click)="deletePartner(id, item)"
          style="background-color: #ffffff; cursor: pointer">{{
          (item.type == 2 ? "xoa_doi_tac_to_chuc" : "xoa_doi_tac_ca_nhan")
          | translate
          }}</u>
      </div>
      <div class="contract__content--participants">
        <div class="row">
          <div class="radio col-md-6 label_type">
            <label><input type="radio" name="type_{{ id }}" [value]="2" [(ngModel)]="item.type"
                (change)="changeType($event, item, id)" />
              <span> {{ "organization" | translate }}</span></label>
          </div>
          <div class="radio col-md-6 label_type">
            <label><input type="radio" name="type_{{ id }}" [value]="3" [(ngModel)]="item.type"
                (change)="changeType($event, item, id)" />
              <span> {{ "personal" | translate }}</span></label>
          </div>
        </div>

        <!--Đối tác là tổ chức-->
        <div *ngIf="item.type == 2">
          <!-- điều phối hđ -->
          <div class="participants-border">
            <div class="label">{{ "user.lead" | translate }}</div>
            <div class="participants--content" *ngFor="let d of getPartnerCoordination(item); let index = index">
              <input [id]="'ordering-lead-' + index" class="col-md-1 contract-total" style="width: 25px; height: 25px"
                type="number" [ngModel]="1" disabled />
              <div class="col-md-10 participants__content--input" style="
                  display: flex;
                  flex-direction: column;
                  margin-bottom: 14px;
                ">
                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.name" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/icon_name.svg" class="input-img" />
                      <input type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}" [(ngModel)]="d.name" />
                    </div>
                  </div>
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      Email&nbsp;<span class="required-title">*</span>&nbsp;-&nbsp;
                      <div style="color: #ffc107">
                        ({{
                        'only.match.email.org'
                        | translate
                        }})
                      </div>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img" />
                      <input type="text" placeholder="{{ 'nhap_email' | translate }}" [(ngModel)]="d.email" />
                    </div>
                  </div>
                </div>

                <div *ngIf="this.site == 'NB'" class="participants--input" style="display: flex">
                  <div class="participants__name" style="width:80%; margin-right: -4%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;-&nbsp;<div
                        style="color: #ffc107;">({{'Nhận thông báo khi xử lý hợp đồng' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{ 'nhap_sdt' | translate }}" [(ngModel)]="d.phone"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%">
                    <div class="label_detail text-color"><span class="required-title"></span></div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-1 delete-element" (click)="deletePartnerCoordination(index, item, id)">
                <img src="assets/img/border_close.svg" alt="close.vn" />
                <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
              </div>
            </div>
            <div *ngIf="getPartnerCoordination(item).length < 1" class="participants--add">
              <u class="label text-color" (click)="addPartnerCoordination(item, id)">{{ "btn.add.user.lead" | translate
                }}</u>
            </div>
          </div>

          <!--Người xem xét đối tác tổ chức-->
          <div class="participants-border">
            <div class="label">{{ "user.view" | translate }}</div>
            <div class="participants--content" *ngFor="let d of getPartnerReviewer(item); let index = index">
              <input [id]="'ordering-view-' + index" class="col-md-1 contract-total"
                (focusout)="onChangeValue($event, 'ordering-view-' + index)" style="width: 25px; height: 25px"
                type="number" [(ngModel)]="d.ordering" [disabled]="getPartnerReviewer(item).length == 1"
                oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
              <div class="col-md-10 participants__content--input">

                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">

                      <div>
                        <input (change)="changeTypeSign(d)" type="radio" name="checkPhoneMailPartReview_{{index}}"
                          [value]="email" [(ngModel)]="d.login_by" />
                      </div>&nbsp;
                      <div>
                        {{'typeOfSignEmail' | translate}}
                      </div>
                    </div>
                  </div>
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      <div>
                        <input (change)="changeTypeSign(d)" type="radio" name="checkPhoneMailPartReview_{{index}}"
                          [(ngModel)]="d.login_by" [value]="phone" />
                      </div>&nbsp;
                      <div>
                        {{'typeOfSignPhone' | translate}}
                      </div>
                    </div>
                  </div>
                </div>

                <div class="participants--input">
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.name" | translate }}&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/icon_name.svg" class="input-img" />
                      <input *ngIf="d.login_by === 'email'" type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}"
                        (focusin)="onFocusIn($event, index, 'view')"
                        (ngxInputSearch)="doTheSearch($event, index, 'view')" [(ngModel)]="d.name"
                        (focusout)="onFocusOut($event, d)" />

                      <input *ngIf="d.login_by === 'phone'" type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}"
                        (focusin)="onFocusIn($event, index, 'view')" [(ngModel)]="d.name"
                        (focusout)="onFocusOut($event, d)" />
                    </div>
                  </div>

                  <!--NB-->
                  <div class="participants__name" *ngIf="d.login_by == 'email' && this.site == 'NB'">
                    <div class="label_detail text-color">Email&nbsp;<span class="required-title">*</span></div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" *ngIf="d.login_by == 'phone' && this.site == 'NB'">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div style="display: flex;">
                    <div class="input-data" style="width: 91%;margin-right: -3%;">
                      <img class="input-img">
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                    </div>

                    <div class="participants__name" style="width: 17%;margin-left: 5%;">
                      <div class="input-data">
                        <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                          <div *ngIf="d.locale =='vi'">
                            <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div *ngIf="d.locale =='en'">
                            <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                            <div class="switch-language">
                              <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                                <div class="language">{{ "vie" | translate }}</div>
                              </button>
                            </div>
                            <div class="switch-language">
                              <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                                <div class="language">{{ "eng" | translate }}</div>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  </div>

                  <!--KD-->
                  <div class="participants__name" *ngIf="d.login_by == 'email' && this.site == 'KD'">
                    <div class="label_detail text-color">Email&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" *ngIf="d.login_by == 'phone' && this.site == 'KD'">
                    <div style="display: flex;">
                      <div class="participants__name" style="width: 91%;">
                        <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                          <span class="required-title">*</span>
                        </div>
                        <div class="input-data">
                          <img class="input-img">
                          <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                        </div>
                      </div>

                      <div class="participants__name" style="width: 16%; margin-left: 2%;">
                        <div class="label_detail text-color"><span class="required-title"></span></div>
                        <div class="input-data">
                          <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                            <div *ngIf="d.locale =='vi'">
                              <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                                id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                            </div>
                            <div *ngIf="d.locale =='en'">
                              <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                                id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                            </div>
                            <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                              <div class="switch-language">
                                <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                                  <div class="language">{{ "vie" | translate }}</div>
                                </button>
                              </div>
                              <div class="switch-language">
                                <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                                  <div class="language">{{ "eng" | translate }}</div>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!--NB email-->
                <div *ngIf="this.site == 'NB' && d.login_by === 'email'" class="participants--input"
                  style="display: flex">
                  <div class="participants__name" style="width:80%; margin-right: -4%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<div style="color: #ffc107;">
                        ({{'receive.contract.process' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <img class="input-img">
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%">
                    <div class="label_detail text-color"><span class="required-title"></span></div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-1 delete-element" (click)="deletePartnerReviewer(index, item, id)">
                <img src="assets/img/border_close.svg" alt="close.vn" />
                <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
              </div>
            </div>
            <div class="participants--add">
              <u class="label text-color" (click)="addPartnerReviewer(item, id)">{{ "btn.add.user.view" | translate
                }}</u>
            </div>
          </div>

          <!--Người ký đối tác-->
          <div class="participants-border">
            <div class="label">{{ "user.sign" | translate }}</div>
            <div class="participants--content" *ngFor="let d of getPartnerSignature(item); let index = index">
              <input [id]="'ordering-sign-partner-' + index" (focusout)="
                  onChangeValue($event, 'ordering-sign-partner-' + index)
                " class="col-md-1 contract-total" style="width: 25px; height: 25px" type="number"
                [(ngModel)]="d.ordering"
                oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');"
                [disabled]="getPartnerSignature(item).length == 1" />
              <div class="col-md-10 participants__content--input" style="display: flex; flex-direction: column">
                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">

                      <div>
                        <input (change)="changeTypeSign(d, index,id, 'sign_partner')" type="radio" name="checkPhoneMailPartSign_{{index}}_{{id}}"
                          [value]="email" [(ngModel)]="email" />
                      </div>&nbsp;
                      <div>
                        {{'typeOfSignEmail' | translate}}
                      </div>
                    </div>
                  </div>
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      <div>
                        <input (change)="changeTypeSign(d, index,id, 'sign_partner')" type="radio" name="checkPhoneMailPartSign_{{index}}_{{id}}"
                          [(ngModel)]="d.login_by" [value]="phone" />
                      </div>&nbsp;
                      <div>
                        {{'typeOfSignPhone' | translate}}
                      </div>
                    </div>
                  </div>
                </div>

                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.name" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/icon_name.svg" class="input-img" />
                      <input [id]="'signature-partner-' + d.ordering" type="text"
                        placeholder="{{ 'nhap_ho_va_ten' | translate }}" [(ngModel)]="d.name" />
                    </div>
                  </div>

                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.sign-type" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>

                    <ng-multiselect-dropdown [(ngModel)]="d.sign_type" placeholder="{{ 'choose' | translate }}"
                      [settings]="dropdownSignTypeSettings" [data]="d.isListSignNotPersonPartner ? d.isListSignNotPersonPartner : this.getListSignType('partner')"
                      (onSelect)="onItemSelect($event)" (ngModelChange)="selectWithOtp($event, d)">
                      <ng-template #optionsTemplate let-item let-option="option" let-id="id"
                        let-isSelected="isSelected">
                        <div style="
                            padding: 1px 10px;
                            margin-right: 10px;
                            right: 2px;
                            top: -2px;
                          ">
                          <label style="color: #333; font-weight: normal" [ngStyle]="{
                              'font-weight': isSelected ? 'bold' : ' normal',
                              color: getContractConnectItems[id].isDisabled
                                ? 'lightgrey'
                                : ''
                            }">
                            {{ getContractConnectItems[id].name }}
                          </label>
                        </div>
                      </ng-template>
                    </ng-multiselect-dropdown>
                  </div>
                </div>


                <!--KD-->
                <div *ngIf="this.site == 'KD'" class="participants--input" style="display: flex">
                  <div *ngIf="d.login_by === 'email'" class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">Email&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div *ngIf="d.login_by === 'phone'" class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div style="display: flex;">
                      <div class="input-data" style="width: 85%;">
                        <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                        <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                      </div>

                      <div class="input-data" style="width: 7%;margin-left: 8%;">
                        <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                          <div *ngIf="d.locale =='vi'">
                            <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div *ngIf="d.locale =='en'">
                            <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                              id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                          </div>
                          <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                            <div class="switch-language">
                              <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                                <div class="language">{{ "vie" | translate }}</div>
                              </button>
                            </div>
                            <div class="switch-language">
                              <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                                <div class="language">{{ "eng" | translate }}</div>
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!--NB email-->
                <div *ngIf="this.site == 'NB' && d.login_by === 'email'" class="participants--input"
                  style="display: flex">
                  <div class="participants__name" style="margin-left: 4%;">
                    <div class="label_detail text-color">Email&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 34%; margin-left: 8%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<div style="color: #ffc107;">
                        ({{'receive.contract.process' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%; margin-right: 4%;">
                    <div class="label_detail text-color"><span class="required-title"></span></div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!--NB phone-->
                <div *ngIf="this.site == 'NB' && d.login_by === 'phone'" class="participants--input"
                  style="display: flex">
                  <div class="participants__name" style="width:80%; margin-right: -4%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<span
                        class="required-title">*</span></div>
                    <div class="input-data">
                      <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%">
                    <div class="label_detail text-color">
                      <span class="required-title"></span>
                    </div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="participants--input" style="display: flex" *ngIf="getDataSignEkyc(d).length > 0">
                  <div class="participants__name" style="width: 90%">
                    <div class="label_detail text-color">
                      {{'cardId' | translate}}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{ 'enter.cardId' | translate }}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
                    </div>
                  </div>
                </div>

                <!--Check ký usb token cho đối tác, nếu có thì render trường mã số thuế/cccd-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignUSBToken(d).length > 0">
                  <div class="participants__name" style="width: 90%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;<span
                        class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.token' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

                <!--trường hiển thị khi người ký của đối tác chọn loại ký là hsm-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignHsm(d).length > 0">
                  <div class="participants__name" style="width: 90%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;<span
                        class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.hsm' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

                <!--trường hiển thị khi người ký của đối tác chọn loại ký là chứng thư số-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignCert(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;
                      <span class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.cert' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

              </div>
              <div *ngIf="
                  getPartnerSignature(item).length > 1 ||
                  this.getPartnerCoordination(item).length > 0
                " class="col-md-1 delete-element" (click)="deletePartnerSignature(index, item)">
                <img src="assets/img/border_close.svg" alt="close.vn" />
                <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
              </div>
              <div *ngIf="
                  getPartnerSignature(item).length == 1 &&
                  this.getPartnerCoordination(item).length == 0
                " class="col-md-1 delete-element"></div>
            </div>
            <div class="participants--add">
              <u class="label text-color" style="color: #106db6" (click)="addPartnerSignature(item, id)">{{
                "btn.add.user.sign" | translate }}</u>
            </div>
          </div>

          <!--Người ký văn thư-->
          <div class="participants-border">
            <div class="label">{{ "user.doc" | translate }}</div>
            <div class="participants--content" *ngFor="let d of getPartnerDocument(item); let index = index">
              <input [id]="'ordering-partner-doc-' + index" (focusout)="
                  onChangeValue($event, 'ordering-partner-doc-' + index)
                " class="col-md-1 contract-total" style="width: 25px; height: 25px" type="number"
                [(ngModel)]="d.ordering"
                oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');"
                [disabled]="getPartnerDocument(item).length == 1" />
              <div class="col-md-10 participants__content--input" style="display: flex; flex-direction: column">
                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.name" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/icon_name.svg" class="input-img" />
                      <input type="text" placeholder="{{ 'nhap_ho_va_ten' | translate }}"
                        (focusin)="onFocusIn($event, index, 'doc')" (ngxInputSearch)="doTheSearch($event, index, 'doc')"
                        [(ngModel)]="d.name" (focusout)="onFocusOut($event, d)" />
                    </div>
                    <div class="search-name" *ngIf="
                        this.arrSearch[index] &&
                        this.arrSearchNameDoc &&
                        arrSearchNameDoc.length > 0
                      ">
                      <button class="search-name-items" *ngFor="let t of this.arrSearchNameDoc"
                        (click)="onSelectName(t, d)">
                        {{ t.name }} ({{ t.email }})
                      </button>
                    </div>
                  </div>

                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.sign-type" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>
                    <ng-multiselect-dropdown [(ngModel)]="d.sign_type" placeholder="{{ 'choose' | translate }}"
                      [settings]="dropdownSignTypeSettings" [data]="signType_doc"
                      (ngModelChange)="selectWithOtp($event, d)">
                      <ng-template #optionsTemplate let-item let-option="option" let-id="id"
                        let-isSelected="isSelected">
                        <div style="
                            padding: 1px 10px;
                            margin-right: 10px;
                            right: 2px;
                            top: -2px;
                          ">
                          <label style="color: #333; font-weight: normal" [ngStyle]="{
                              'font-weight': isSelected ? 'bold' : ' normal',
                              color: getContractConnectItems[id].isDisabled
                                ? 'lightgrey'
                                : ''
                            }">
                            {{ getContractConnectItems[id].name }}
                          </label>
                        </div>
                      </ng-template>
                    </ng-multiselect-dropdown>
                  </div>
                </div>


                <!--NB-->
                <div class="participants--input" style="display: flex" *ngIf="this.site == 'NB'">
                  <div class="participants__name" style="margin-left: 4%;">
                    <div class="label_detail text-color">Email&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 34%; margin-left:8%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<div style="color: #ffc107;">
                        ({{'receive.contract.process' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <img class="input-img">
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%; margin-right: 4%;">
                    <div class="label_detail text-color">
                      <span class="required-title"></span>
                    </div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!--KD-->
                <div class="participants--input" style="display: flex" *ngIf="this.site == 'KD'">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">Email&nbsp;<span class="required-title">*</span></div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>
                </div>

                <div class="participants--input" style="display: flex" *ngIf="getDataSignEkyc(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">
                      {{'cardId' | translate}}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{ 'enter.cardId' | translate }}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
                    </div>
                  </div>
                </div>

                <!--trường hiển thị khi văn thư đối tác của tổ chức chọn loại ký là usb token-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignUSBToken(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;<span
                        class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.token' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

                <!--trường hiển thị khi văn thư tổ chức của tôi chọn loại ký là hsm-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignHsm(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code' | translate}}&nbsp;<span
                        class="required-title">*</span></div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax.code' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

                <!--trường hiển thị khi văn thư đối tác chọn loại ký là chứng thư số-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignCert(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;
                      <span class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.cert' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

              </div>
              <div class="col-md-1 delete-element" (click)="deletePartnerDocument(index, item)">
                <img src="assets/img/border_close.svg" alt="close.vn" />
                <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
              </div>
            </div>
            <div class="participants--add">
              <u class="label text-color" style="color: #106db6" (click)="addPartnerDocument(item, id)">{{
                "btn.add.user.doc" | translate }}</u>
            </div>
          </div>
        </div>

        <!--Cá nhân-->
        <div *ngIf="item.type == 3">
          <div class="participants-border">
            <div class="label">{{ "user.sign" | translate }}</div>
            <div class="participants--content" *ngFor="let d of getPartnerSignature(item); let index = index">
              <input [id]="'ordering-sign-partner-' + index" (focusout)="
                  onChangeValue($event, 'ordering-sign-partner-' + index)
                " class="col-md-1 contract-total" style="width: 25px; height: 25px" type="number"
                oninput="this.value = this.value.replace(/[^0-9.]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');"
                [(ngModel)]="d.ordering" [disabled]="getPartnerSignature(item).length == 1" />
              <div class="col-md-10 participants__content--input" style="display: flex; flex-direction: column">

                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">

                      <div>
                        <input (change)="changeTypeSign(d, index,null,'personal')" type="radio" name="checkPhoneMailPerson_{{index}}_{{id}}"
                          [value]="email" [(ngModel)]="d.login_by" />
                      </div>&nbsp;
                      <div>
                        {{'typeOfSignEmail' | translate}}
                      </div>
                    </div>
                  </div>
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      <div>
                        <input (change)="changeTypeSign(d, index,null,'personal')" type="radio" name="checkPhoneMailPerson_{{index}}_{{id}}"
                          [(ngModel)]="d.login_by" [value]="phone" />
                      </div>&nbsp;
                      <div>
                        {{'typeOfSignPhone' | translate}}
                      </div>
                    </div>
                  </div>
                </div>

                <div class="participants--input" style="display: flex">
                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.name" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <img src="assets/img/icon_name.svg" class="input-img" />
                      <input [id]="'signature-partner-' + d.ordering" type="text"
                        placeholder="{{ 'nhap_ho_va_ten' | translate }}" [(ngModel)]="d.name"
                        (change)="getName($event, item)" />
                    </div>
                  </div>

                  <div class="participants__name">
                    <div class="label_detail text-color">
                      {{ "user.sign-type" | translate }}&nbsp;<span class="required-title">*</span>
                    </div>

                    <!--Đối tác là cá nhân chọn loại ký-->
                    <ng-multiselect-dropdown [(ngModel)]="d.sign_type" placeholder="{{ 'choose' | translate }}"
                      [settings]="dropdownSignTypeSettings" [data]="d.isListSignPersonal ? d.isListSignPersonal : this.getListSignType('personal')"
                      (onSelect)="selectPartnerSign($event, id)" (onDeSelect)="deSelectPartnerSign($event, id)"
                      (ngModelChange)="selectWithOtp($event, d, 'organization')">
                      <ng-template #optionsTemplate let-item let-option="option" let-id="id"
                        let-isSelected="isSelected">
                        <div style="
                            padding: 1px 10px;
                            margin-right: 10px;
                            right: 2px;
                            top: -2px;
                          ">
                          <label style="color: #333; font-weight: normal" [ngStyle]="{
                              'font-weight': isSelected ? 'bold' : ' normal',
                              color: getContractConnectItems[id].isDisabled
                                ? 'lightgrey'
                                : ''
                            }">
                            {{ getContractConnectItems[id].name }}
                          </label>
                        </div>
                      </ng-template>
                    </ng-multiselect-dropdown>
                  </div>
                </div>

                <div *ngIf="this.site == 'KD'" class="participants--input" style="display: flex">

                  <div *ngIf="d.login_by === 'phone'" class="participants__name" style="width:91%">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div style="display: flex;">
                    <div class="input-data" style="width: 85%;">
                      <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                    </div>

                    <div class="input-data" style="width: 7%;margin-left: 8%;">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  </div>

                  <div *ngIf="d.login_by === 'email'" class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">Email&nbsp;<span class="required-title">*</span></div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>
                </div>

                <!--NB email-->
                <div *ngIf="this.site == 'NB' && d.login_by === 'email'" class="participants--input"
                  style="display: flex">
                  <div class="participants__name" style="margin-left: 4%;">
                    <div class="label_detail text-color">Email&nbsp;<span class="required-title">*</span></div>
                    <div class="input-data">
                      <img src="assets/img/login_email.svg" class="input-img">
                      <input type="text" placeholder="{{'nhap_email' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 34%; margin-left: 8%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<span
                        *ngIf="getDataSignCka(d).length > 0" class="required-title">*</span>
                      <div style="color: #ffc107;">({{'receive.contract.process' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%; margin-right: 4%;">
                    <div class="label_detail text-color"><span class="required-title"></span></div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!--NB phone-->
                <div *ngIf="this.site == 'NB' && d.login_by === 'phone'" class="participants--input"
                  style="display: flex">
                  <div class="participants__name" style="width:80%; margin-right: -4%;">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;<span
                        class="required-title">*</span></div>
                    <div class="input-data">
                      <!-- <img src="assets/img/login_email.svg" class="input-img"> -->
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.email">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%">
                    <div class="label_detail text-color"><span class="required-title"></span></div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>


                <div class="participants--input" style="display: flex" *ngIf="getDataSignEkyc(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">
                      {{'cardId' | translate}}&nbsp;<span class="required-title">*</span>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{ 'enter.cardId' | translate }}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');" />
                    </div>
                  </div>
                </div>

                <!--KD-->
                <div class="participants--input" style="display: flex"
                  *ngIf="this.site === 'KD' && getDataSignCka(d).length > 0 && d.login_by == 'email'">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'user.phone' | translate}}&nbsp;
                      <span class="required-title">*</span>
                    </div>
                    <div class="input-data" style="width: 85%;">
                      <input type="text" placeholder="{{'nhap_sdt' | translate}}" [(ngModel)]="d.phone"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>

                  <div class="participants__name" style="width: 6%; margin-left: -15%;">
                    <div class="label_detail text-color"><span class="required-title"></span></div>
                    <div class="input-data">
                      <div ngbDropdown class="d-inline-block" style="margin-left: 6px;" [(ngModel)]="d.locale">
                        <div *ngIf="d.locale =='vi'">
                          <button *ngIf="d.locale =='vi'" class="btn btn-outline-primary db_icon_vietnam"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div *ngIf="d.locale =='en'">
                          <button *ngIf="d.locale =='en'" class="btn btn-outline-primary db_icon_english"
                            id="dropdownMenu1" ngbDropdownToggle>{{dropdownButtonText}}</button>
                        </div>
                        <div ngbDropdownMenu aria-labelledby="dropdownMenu1" style="min-width: 6rem;">
                          <div class="switch-language">
                            <button class="db_icon_vietnam" ngbDropdownItem (click)="d.locale = 'vi'">
                              <div class="language">{{ "vie" | translate }}</div>
                            </button>
                          </div>
                          <div class="switch-language">
                            <button class="db_icon_english" ngbDropdownItem (click)="d.locale = 'en'">
                              <div class="language">{{ "eng" | translate }}</div>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>


                <!--Check ký usb token cho cá nhân, nếu có thì render trường mã số thuế/cccd-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignUSBToken(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;<span
                        class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.token' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

                <div class="participants--input" style="display: flex" *ngIf="getDataSignHsm(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code' | translate}}&nbsp;<span
                        class="required-title">*</span></div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax.code' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

                <!--trường hiển thị khi người ký đối tác cá nhân chọn loại ký là chứng thư số-->
                <div class="participants--input" style="display: flex" *ngIf="getDataSignCert(d).length > 0">
                  <div class="participants__name" style="width: 91%">
                    <div class="label_detail text-color">{{'tax_code.cardId' | translate}}&nbsp;
                      <span class="required-title">*</span>
                      <div style="color: #ffc107;">({{'info.cert' | translate}})</div>
                    </div>
                    <div class="input-data">
                      <input type="text" placeholder="{{'enter.tax_code.cardId' | translate}}" [(ngModel)]="d.card_id"
                        oninput="this.value = this.value.replace(/[\s]/g, '', /[^\d*[.]?\d*$]/g).replace(/(\..*?)\..*/g, '$1');">
                    </div>
                  </div>
                </div>

              </div>

              <div *ngIf="getPartnerSignature(item).length > 1" class="col-md-1 delete-element"
                (click)="deletePartnerSignature(index, item)">
                <img src="assets/img/border_close.svg" alt="close.vn" />
                <img class="close-btn" src="assets/img/x_close.svg" alt="close.vn" />
              </div>
              <div *ngIf="getPartnerSignature(item).length == 1" class="col-md-1 delete-element"></div>
            </div>
            <div *ngIf="getPartnerSignature(item).length > 1" class="participants--add">
              <u class="label text-color" style="color: #106db6" (click)="addPartnerSignature(item, id)">{{
                "btn.add.user.sign" | translate }}</u>
            </div>
          </div>
          <!--          </div>-->
        </div>
      </div>
    </div>
  </div>
</div>

<!--ẩn tạm thời-->
<div style="display: flex">
  <div style="margin-right: 80px">
    <div style="display: inline-block; cursor: pointer">
      <u class="label text-color" (click)="addPartner()" style="background-color: #ffffff">{{ "them_doi_tac" | translate
        }}</u>
    </div>
  </div>
</div>

<div class="footer-determine" style="display: flex; justify-content: space-between">
  <div style="width: 200px">
    <button (click)="back($event, 'infor-contract-form')" type="button" name="next" class="next action-button"
      style="background-color: #8b8b8b">
      {{ "btn.previous" | translate }}
    </button>
  </div>
  <div>
    <button [disabled]="isButtonDisabled" type="button" name="next" class="next draft-button" (click)="next('save-draft')">
      {{ "btn.save-draft" | translate }}
    </button>
    <button [disabled]="isButtonDisabled" (click)="next('save-step')" type="button" name="next" class="next action-button pull-right">
      {{ "btn.next" | translate }}
    </button>
  </div>
</div>

<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-spin-clockwise">
  <p style="font-size: 18px; color: white">{{'sys.processing' | translate}}...</p>
</ngx-spinner>
