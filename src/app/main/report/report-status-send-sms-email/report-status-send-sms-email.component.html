<div>
  <div class="row">
    <!--Tổ chức-->
    <div class="col-md-2">
      <div>{{'organization' | translate}}</div>
      <div class="input-line">
        <p-treeSelect #nameContract [(ngModel)]="selectedNodeOrganization" [filter]="true" filterBy="name"
          [droppable]="true" [options]="listOrgCombobox" (onNodeSelect)="changeOrg()">
        </p-treeSelect>
      </div>
    </div>

    <!-- Thông tin hợp đồng -->
    <div class="col-md-2">
      <div>{{'contract.information' | translate}}</div>
      <div class="input-line">
        <input type="text" [(ngModel)]="contractInfo" class="input_text" placeholder="Tìm kiếm theo Mã HĐ, Số HĐ" />
      </div>
    </div>

    <!--Trạng thái hợp đồng -->
    <!-- <div class="col-md-2">
      <div>{{'contract.status.v2' | translate}}</div>
      <div class="input-line">
          <p-dropdown
              [(ngModel)] = "contractStatus"
              panelStyleClass="font"
              appendTo="body"
              optionLabel="name"
              optionValue="id"
              placeholder="{{'all' | translate}}"
              [showClear]="true"
              [options]="optionsStatus"
              [autoDisplayFirst]="false"
          ></p-dropdown>
      </div>
    </div> -->

    <!--Thời gian gửi-->
    <div class="col-md-2">
      <div>{{ 'time.send.date' | translate}}
        <!-- <span style="color: red"> *</span> -->
      </div>
      <div class="input-line">
        <p-calendar [readonlyInput]="true" [(ngModel)]="date" [showIcon]="true" selectionMode="range"
          dateFormat="dd/mm/yy"></p-calendar>
      </div>
    </div>


    <!--Button-->
    <div class="col-md-4 btn_search">
      <button class="btn btn-lg btn-block btn_submit" (click)="exportSmsReportCall(false)">{{'btn.report' | translate
        }}</button>
      <button class="btn btn-lg btn-block btn_submit" (click)="exportSmsReportCall(true)">Export</button>
    </div>
  </div>


  <!--Bảng dữ liệu-->
  <div class="row" style="padding-top: 30px;">
    <p-table #dt [value]="list" [paginator]="true" [rows]="10" id="table" [autoLayout]="true">

      <!--header-->
      <ng-template pTemplate="header">
        <tr>
          <th *ngFor="let col of cols" [style]='col.style' [colSpan]="col.colspan" [rowSpan]="col.rowspan">
            {{col.header | translate}}
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-list let-row="rowIndex">
        <tr>
          <ng-container *ngIf="row >= 0">
            <td>{{list.contractUuid}}</td> <!--mã hđ-->
            <td>{{list.contractNo}}</td> <!--số hđ-->
            <td>{{list.contractName}}</td> <!--Tên HĐ-->
            <td style="text-align: center; ">{{list.emailOrPhone}}</td> <!--SĐT-->
            <td style="text-align: center; ">
              <img ngbTooltip="{{'content' | translate}}" src="../../../assets/img/icon_file_sms.svg" width="20px"
                (click)="contentSMS(list.dataSendLog)" style="cursor: pointer;" />
            </td>
            <td>{{convertTime(list.createDate)}}</td> <!--Thời gian gửi-->
            <td [ngStyle]="{color: list.status == 'Thành công' ? 'green' : 'red'}" style="text-align: center; ">
              {{list.status}}</td> <!--Trạng thái gửi-->
            <td *ngIf="list.contractStatus == 20" style="text-align: center;">{{'sys.processing' | translate}}</td>
            <td *ngIf="list.contractStatus == 2" style="text-align: center;">{{'contract.status.overdue' | translate}}</td>
            <td *ngIf="list.contractStatus == 31" style="text-align: center;">{{'contract.status.fail' | translate}}</td>
            <td *ngIf="list.contractStatus == 32" style="text-align: center;">{{'contract.status.cancel' | translate}}</td>
            <td *ngIf="list.contractStatus == 30" style="text-align: center;">{{'contract.status.complete' | translate}}</td>
          </ng-container>
        </tr>
      </ng-template>

      <ng-template pTemplate="paginatorleft" let-state>
        <span style="color: white !important;">{{'chart.number' | translate}}: {{state.first <= 0 && state.totalRecords
            <=1? 0:state.first + 1}} - {{(state.first+state.rows)> state.totalRecords ? (state.totalRecords > 0 ?
            state.totalRecords - 1 : 0) : state.first+state.rows}} / {{state.totalRecords > 0 ? state.totalRecords - 1 :
            0}}</span>
      </ng-template>
      <ng-template pTemplate="paginatorright" let-state>
        <span style="color: #0160AE !important;">
          {{'chart.number' | translate}}:
          {{state.first <= 0 && state.totalRecords <=1? 0:state.first + 1}} - {{(state.first+state.rows)>
            state.totalRecords ?(state.totalRecords > 0 ? state.totalRecords : 0) : state.first+state.rows}} /
            {{state.totalRecords > 0 ? state.totalRecords : 0}}
        </span>
      </ng-template>
    </p-table>
  </div>
</div>

<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-spin-clockwise">
  <p style="font-size: 18px; color: white">{{'sys.processing' | translate}}...</p>
</ngx-spinner>
